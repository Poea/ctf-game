'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else {return get(parent,property,receiver)}}else if('value' in desc){return desc.value}else {var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};var _shortid=require('shortid');var _shortid2=_interopRequireDefault(_shortid);var _lodash=require('lodash');var _session=require('../session');var _session2=_interopRequireDefault(_session);var _entity=require('../../actions/entity');var _game=require('../../helpers/game');var _constants=require('../../../shared/constants');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Castle=function(_Session){_inherits(Castle,_Session); /**
   * Creates a new game session.
   * @param io
   */function Castle(io){_classCallCheck(this,Castle);return _possibleConstructorReturn(this,Object.getPrototypeOf(Castle).call(this,'castle',io))} /**
   * Creates this session.
   */_createClass(Castle,[{key:'create',value:function create(){this.createTeams();this.createFlags()} /**
   * Creates the teams for this session.
   */},{key:'createTeams',value:function createTeams(){var _this2=this;var teamColorProps=[{color:'blue',hexColor:'#46bce3'},{color:'green',hexColor:'#86d93d'},{color:'orange',hexColor:'#fda551'},{color:'purple',hexColor:'#9c44b5'}];var baseObjects=this.getGameData('map.objects').filter(function(object){return object.type==='base'});(0,_lodash.forEach)(teamColorProps,function(props,index){_this2.dispatch((0,_entity.addEntity)(_extends({},props,{type:_constants.EntityTypes.TEAM,id:_shortid2.default.generate(),base:(0,_lodash.pick)(baseObjects[index],['x','y','width','height'])})))})} /**
   * Creates the flags for this session.
   */},{key:'createFlags',value:function createFlags(){var _this3=this;var flagObjects=this.getGameData('map.objects').filter(function(object){return object.type==='flag'});(0,_lodash.forEach)(flagObjects,function(props){_this3.dispatch((0,_entity.addEntity)(_extends({},props,{id:_shortid2.default.generate(),type:_constants.EntityTypes.FLAG})))})} /**
   * Adds a player to this session.
   * @param {Object} props
   */},{key:'addPlayer',value:function addPlayer(props){_get(Object.getPrototypeOf(Castle.prototype),'addPlayer',this).call(this,props);var teamId=(0,_game.findWeakestTeamId)(this.gameState.entities);this.dispatch((0,_entity.joinTeam)(teamId,props.id))} /**
   * Removes a player from this session.
   * @param {string} id
   */},{key:'removePlayer',value:function removePlayer(id){_get(Object.getPrototypeOf(Castle.prototype),'removePlayer',this).call(this,id);this.dispatch((0,_entity.leaveTeam)(id))}}]);return Castle}(_session2.default);exports.default=Castle;
//# sourceMappingURL=castle.js.map