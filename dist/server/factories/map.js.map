{"version":3,"sources":["../../../src/server/factories/map.js"],"names":[],"mappings":"8EASgB;;;;GAAT,SAAS,SAAT,CAAmB,GAAnB,CAAwB,CAC7B,IAAM,SAAW,0CAAX,CADuB,GAGzB,CAAC,SAAS,GAAT,CAAD,CAAgB,CAClB,MAAM,IAAI,KAAJ,CAAU,sCAAV,CAAN,CADkB,IAId,QAAU,SAAS,GAAT,CAAV,CAPuB,IAQvB,KAAO,iCAAwB,QAAQ,GAAR,CAA/B,CARuB,GAUzB,CAAC,IAAD,CAAO,CACT,MAAM,IAAI,KAAJ,CAAU,6BAAV,CAAN,CADS,IAIL,QAAU,EAAV,CAduB,mBAgB7B,CAAQ,KAAK,MAAL,CAAa,eAAS,CAC5B,GAAI,MAAM,IAAN,2BAAJ,CAAkC,CAChC,oBAAQ,MAAM,OAAN,CAAe,gBAAU,CAC/B,QAAQ,IAAR,CAAa,MAAb,EAD+B,CAAjC,CADgC,CADf,CAArB,CAhB6B,OAwBtB,CACL,GAAI,kBAAQ,QAAR,EAAJ,CACA,IAAK,GAAL,CACA,MAAO,QAAQ,KAAR,CACP,MAAO,QAAQ,KAAR,CACP,KAAM,IAAN,CACA,OAAQ,KAAK,MAAL,CACR,MAAO,KAAK,KAAL,CAAa,KAAK,QAAL,CAAc,CAAd,EAAiB,SAAjB,CACpB,OAAQ,KAAK,MAAL,CAAc,KAAK,QAAL,CAAc,CAAd,EAAiB,UAAjB,CACtB,QAAS,OAAT,CATF,CAxB6B","file":"map.js","sourcesContent":["import shortid from 'shortid';\nimport { forEach } from 'lodash';\nimport { DATA_PATH, LAYER_OBJECTS } from '../constants';\n\n/**\n *\n * @param {string} key\n * @returns {Object}\n */\nexport function createMap(key) {\n  const mapsData = require(`${DATA_PATH}/maps.json`);\n\n  if (!mapsData[key]) {\n    throw new Error('Failed to load data for unknown map.');\n  }\n\n  const mapData = mapsData[key];\n  const json = require(`${DATA_PATH}/${mapData.src}`);\n\n  if (!json) {\n    throw new Error('Failed to load unknown map.');\n  }\n  \n  const objects = [];\n\n  forEach(json.layers, layer => {\n    if (layer.type === LAYER_OBJECTS) {\n      forEach(layer.objects, object => {\n        objects.push(object);\n      });\n    }\n  });\n\n  return {\n    id: shortid.generate(),\n    key: key,\n    image: mapData.image,\n    music: mapData.music,\n    data: json,\n    layers: json.layers,\n    width: json.width * json.tilesets[0].tilewidth,\n    height: json.height * json.tilesets[0].tileheight,\n    objects: objects\n  };\n}\n"]}