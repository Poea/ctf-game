{"version":3,"sources":["../../../src/server/factories/entity.js"],"names":[],"mappings":"8EAuEgB;;;;;wDArDhB,SAAS,YAAT,CAAsB,OAAtB,CAA+B,KAA/B,CAAsC,CACpC,IAAM,OAAS,qBAAW,KAAX,CAAT,CAD8B,IAG9B,eAAiB,SAAjB,cAAiB,CAAS,KAAT,CAAgB,QAAhB,CAA0B,CAC/C,GAAI,CAAC,MAAM,MAAN,EAAgB,MAAM,aAAN,EAAuB,CAAvB,CAA0B,CAC7C,SAAS,qBAAW,MAAM,EAAN,CAAU,MAAM,cAAN,CAA9B;AAD6C,UAI7C,CAAW,UAAM,CACf,SAAS,sBAAY,MAAM,EAAN,CAArB,EADe,UAGf,CAAW,UAAM,CACf,SAAS,oBAAU,MAAM,EAAN,CAAnB,EADe,CAEd,GAFH,EAHe,CAMd,MAAM,cAAN,CANH,CAJ6C,CAD1B,CAHa,MAkBpC,CAAO,YAAP,CAAoB,qBAAW,cAAX,CAApB,EAlBoC,OAoB7B,MAAP,CApBoC;;;;;GA6BtC,SAAS,UAAT,CAAoB,OAApB,CAA6B,KAA7B,CAAoC,CAClC,IAAM,OAAS,qBAAW,KAAX,CAAT,CAD4B,OAG3B,MAAP,CAHkC;;;;;GAYpC,SAAS,UAAT,CAAoB,OAApB,CAA6B,KAA7B,CAAoC,CAClC,IAAM,OAAS,qBAAW,KAAX,CAAT,CAD4B,OAG3B,MAAP,CAHkC;;;;;GAY7B,SAAS,YAAT,CAAsB,OAAtB,CAA+B,KAA/B,CAAsC,CAC3C,OAAQ,MAAM,IAAN,EACN,KAAK,QAAL,CACE,OAAO,aAAa,OAAb,CAAsB,KAAtB,CAAP,CADF,KAGK,MAAL,CACE,OAAO,WAAW,OAAX,CAAoB,KAApB,CAAP,CADF,KAGK,MAAL,CACE,OAAO,WAAW,OAAX,CAAoB,KAApB,CAAP,CADF,QAIE,eAAO,IAAP,4CAAuD,MAAM,IAAN,IAAvD,EADF,OAES,IAAP,CAFF,CAXyC,CAAtC","file":"entity.js","sourcesContent":["/*eslint no-shadow: 0*/\n/*eslint no-unused-vars: 0*/\n\nimport { logger } from '../helpers/vendor';\nimport Entity from 'shared/game/entity';\nimport Health from '../game/components/health';\nimport {\n  killEntity,\n  beginRevive,\n  endRevive\n} from '../actions/game';\n\n/**\n *\n * @param {Session} session\n * @param {Object} props\n * @returns {Entity}\n */\nfunction createPlayer(session, props) {\n  const entity = new Entity(props);\n\n  const onHealthUpdate = function(props, dispatch) {\n    if (!props.isDead && props.currentHealth <= 0) {\n      dispatch(killEntity(props.id, props.lastAttackerId));\n\n      // Automatically revive the entity in a while\n      setTimeout(() => {\n        dispatch(beginRevive(props.id));\n\n        setTimeout(() => {\n          dispatch(endRevive(props.id));\n        }, 100);\n      }, props.reviveDuration);\n    }\n  };\n\n  entity.addComponent(new Health(onHealthUpdate));\n\n  return entity;\n}\n\n/**\n *\n * @param {Session} session\n * @param {Object} props\n * @returns {Entity}\n */\nfunction createFlag(session, props) {\n  const entity = new Entity(props);\n\n  return entity;\n}\n\n/**\n *\n * @param {Session} session\n * @param {Object} props\n * @returns {Entity}\n */\nfunction createBase(session, props) {\n  const entity = new Entity(props);\n\n  return entity;\n}\n\n/**\n *\n * @param {Session} session\n * @param {Object} props\n * @returns {Entity}\n */\nexport function createEntity(session, props) {\n  switch (props.type) {\n    case 'player':\n      return createPlayer(session, props);\n\n    case 'flag':\n      return createFlag(session, props);\n\n    case 'base':\n      return createBase(session, props);\n\n    default:\n      logger.warn(`trying to create entity of unknown type ${props.type}.`);\n      return null;\n  }\n}\n"]}